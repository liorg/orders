@model StatusVm

@if (Model.Message != "")
{
    <div class="row">

        <div class="alert @(Model.MessageType == 2 ? "alert-danger" : "alert-warning") ">
            <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
            @Model.Message
        </div>
    </div>
}
<input type="hidden" value="@Model.ShipId" id="hdShipId" name="hdShipId" />
@switch (Model.StatusId.ToString())
{
    case sln.Helper.Status.Draft:
        if (ViewBag.userProfiler.AllowConfirm)
        {
    <div class="row">
        <div class="col-md-12">
            <div class="well well-lg">
                <div class="btn-group">
                    <a class="btn btn-lg btn-success" href="@Url.Action("ApprovalRequest", "Status", new { id = Model.ShipId })">
                        <i class="fa fa-paper-plane fa-2x pull-right"></i>שלח </a>

                </div>
                <div class="btn-group">
                    <a class="btn btn-lg btn-default" href="@(Url.Action("Edit", "S", new { id = Model.ShipId }))">
                        <i class="fa fa-pencil fa-2x pull-right"></i>ערוך </a>
                </div>
                <div class="btn-group">
                    <a class="btn btn-lg btn-danger" href="@(Url.Action("RemoveItem", "Status", new { id = Model.ShipId }))">
                        <i class="fa  fa-times fa-2x pull-right"></i>ביטול הזמנה </a>
                </div>
            </div>
        </div>
    </div>
        }
        break;
    case sln.Helper.Status.ApporvallRequest:
        if (ViewBag.userProfiler.AllowAccept)
        {
    <div class="row">
        <div class="col-md-12">
            <div class="well well-lg">
                <div class="btn-group">
                    <a class="btn btn-lg btn-primary" href="#"><i class="fa fa-thumbs-o-up fa-fw fa-2x"></i><span class="hidden-phone">אושר</span></a>
                    <a class="btn btn-lg btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                        <span class="fa fa-caret-down fa-2x"></span></a>
                    <ul class="dropdown-menu">
                        @foreach (var runner in Model.Runners)
                        {
                            <li><a href="@Url.Action("ConfirmRequest", "Status", new { id = Model.ShipId, assignTo = runner.Id })"><i class="fa fa-hand-o-left fa-fw"></i>@runner.FullName</a></li> 
                            <li class="divider"></li>
                        }
                        <li><a href="@Url.Action("ConfirmRequest", "Status", new { id = Model.ShipId })"><i class="fa fa-repeat fa-fw"></i>העבר אליי</a></li>
                    </ul>
                </div>

                <div class="btn-group">
                    <a class="btn btn-lg btn-danger" href="@Url.Action("CancelRequest", "Status", new { id = Model.ShipId })"><span class="hidden-phone">לא אושר הזמנה</span>  <i class="fa  fa-thumbs-o-down  fa-2x pull-right"></i></a>
                </div>
                @Html.Partial("_editOrder")
            </div>
        </div>
    </div>
        }
        break;
    case sln.Helper.Status.Confirm:
        if (ViewBag.userProfiler.AllowRunner)
        {
    <div class="row">
        <div class="col-md-12">
            <div class="well well-lg">
                <div class="btn-group">
                    <a class="btn btn-lg btn-success" href="@Url.Action("Accept", "Status", new { id = Model.ShipId })">
                        <i class="fa fa-envelope-o fa-2x pull-right"></i><span class="hidden-phone">קבלת המשלוח</span>  </a>

                </div>
                @Html.Partial("_editOrder")
            </div>
        </div>
    </div>
        }
        break;
    case sln.Helper.Status.AcceptByRunner:
        if (ViewBag.userProfiler.AllowRunner)
        {
   
    <div class="row">
        <div class="col-md-12">
            <div class="well well-lg">
                <div class="btn-group">
                    <div class="switch">
                        <input id="chkCheckin" class="cmn-toggle cmn-toggle-yes-no" type="checkbox">
                        <label for="chkCheckin" data-on="הגעתי ליעד" data-off="לא הגעתי"><i class="fa fa-map-marker fa-fw fa-2x"></i></label>
                    </div>
                </div>
                @Html.Partial("_editOrder")
            </div>
        </div>
    </div>
        }
        break;
    case sln.Helper.Status.Arrived:
        if (ViewBag.userProfiler.AllowAccept)
        {
    <div class="row">
        <div class="col-md-12">
            <div class="well well-lg">
                <div class="btn-group">
                    <a class="btn btn-lg btn-primary" data-toggle="modal" data-target="#okModel" href="#"><i class="fa fa-gift fa-fw fa-2x"></i><span class="hidden-phone">התקבל</span> </a>
                </div>
                <div class="btn-group">
                    <a class="btn btn-lg btn-danger" data-toggle="modal" data-target="#noOkModel" href="#" href="#"><span class="hidden-phone">לא התקבל</span><i class="fa  fa-hand-rock-o  fa-2x pull-right"></i></a>
                </div>
                @Html.Partial("_editOrder")
            </div>
        </div>
    </div>
        }
        break;
    default:
    <div></div>
        break;

}

@if (Model.StatusId.ToString() == sln.Helper.Status.Arrived)
{
    
    <div class="modal fade" id="okModel" tabindex="-1" role="dialog" aria-labelledby="okModelLabel">
        <div class="modal-dialog" role="document">
            @using (Html.BeginForm("TakeOk", "Status", FormMethod.Post, new { @id = "frmTake", @name = "frmTake" }))
            {
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="okModelLabel">המשלוח התקבל אצל הלקוח</h4>
                    </div>
                    <div class="modal-body">

                        <input type="hidden" value="@Model.ShipId" id="takeOkId" name="takeOkId" />

                        <div class="form-group">
                            <label for="recipient-name" class="control-label">שם המקבל:</label>
                            <input type="text" value="@Model.Recipient" class="form-control" id="recipient" name="recipient" />

                        </div>
                        <div class="form-group">
                            <label for="message-text" class="control-label">טקסט חופשי:</label>
                            <textarea class="form-control" id="freeText" name="freeText"></textarea>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">ביטול</button>
                        <button type="submit" class="btn btn-primary">שלח</button>
                    </div>
                </div>
            }
        </div>
    </div>


    <div class="modal fade" id="noOkModel" tabindex="-1" role="dialog" aria-labelledby="noOkModelLabel">
        <div class="modal-dialog" role="document">
            @using (Html.BeginForm("NoTake", "Status", FormMethod.Post, new { @id = "frmNoTake", @name = "frmNoTake" }))
            {
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="noOkModelLabel">המשלוח לא התקבל</h4>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" value="@Model.ShipId" id="noTakeOkId" name="takeOkId" />


                        <div class="form-group">
                            <label for="message-text" class="control-label">סיבה :</label>
                            <textarea class="form-control" name="desc"></textarea>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">ביטול</button>
                        <button type="submit" class="btn btn-danger">שלח</button>
                    </div>
                </div>
            }
        </div>
    </div>
    
}